# OpenClaw Security Configuration
# Copy this file to .env and update with your values

# =============================================================================
# ENVIRONMENT
# =============================================================================
NODE_ENV=development
PORT=3000

# =============================================================================
# SECURITY FEATURES
# =============================================================================
ENABLE_SECURITY=true
ENABLE_RATE_LIMITING=true
ENABLE_DDOS_PROTECTION=true
ENABLE_PROMPT_INJECTION=true
ENABLE_SQL_INJECTION=true
ENABLE_XSS=true
ENABLE_CSRF=true
ENABLE_INPUT_VALIDATION=true
ENABLE_AUDIT_LOGGING=true

# =============================================================================
# JWT CONFIGURATION
# =============================================================================
# IMPORTANT: Generate strong keys for production!
# Generate RS256 keys:
#   openssl genrsa -out private.pem 2048
#   openssl rsa -in private.pem -outform PEM -pubout -out public.pem

JWT_SECRET=your-super-secret-key-CHANGE-IN-PRODUCTION
JWT_ALGORITHM=RS256
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d
JWT_PUBLIC_KEY=
JWT_PRIVATE_KEY=

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DATABASE_URL=postgresql://user:password@localhost:5432/openclaw
DATABASE_SSL=false
DATABASE_POOL_SIZE=20
DATABASE_ENABLE_RLS=true

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_TLS=false
REDIS_KEY_PREFIX=openclaw:

# =============================================================================
# VECTOR STORE (QDRANT)
# =============================================================================
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=

# =============================================================================
# GRAPH DATABASE (NEO4J)
# =============================================================================
NEO4J_URL=bolt://localhost:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=password

# =============================================================================
# ENCRYPTION
# =============================================================================
ENCRYPTION_KEY_ID=default-key
KMS_PROVIDER=local # Options: local, aws, azure, gcp, vault

# AWS KMS
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_KMS_KEY_ID=

# Azure Key Vault
AZURE_KEY_VAULT_NAME=
AZURE_TENANT_ID=
AZURE_CLIENT_ID=
AZURE_CLIENT_SECRET=

# HashiCorp Vault
VAULT_URL=http://localhost:8200
VAULT_TOKEN=

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_TIER=standard # Options: standard, enhanced, dedicated
RATE_LIMIT_REDIS_URL=redis://localhost:6379
RATE_LIMIT_DISTRIBUTED=true

# =============================================================================
# DDOS PROTECTION
# =============================================================================
DDOS_IP_LIMIT=1000
DDOS_BLOCK_DURATION=3600
DDOS_AUTO_BLOCK=true

# =============================================================================
# AUDIT LOGGING
# =============================================================================
AUDIT_LOG_STORAGE=postgresql # Options: postgresql, s3, blockchain
AUDIT_LOG_RETENTION_DAYS=2555 # 7 years
AUDIT_LOG_BLOCKCHAIN=false

# AWS S3 (for audit logs)
AWS_S3_BUCKET=
AWS_S3_REGION=us-east-1

# Blockchain (Hyperledger Fabric)
BLOCKCHAIN_NETWORK_URL=
BLOCKCHAIN_CHAINCODE=audit-logs

# =============================================================================
# MONITORING & ALERTING
# =============================================================================
MONITORING_ENABLED=true
METRICS_PORT=9090

# Alerting webhooks
ALERT_WEBHOOK_URL=
SLACK_WEBHOOK_URL=
PAGERDUTY_API_KEY=

# =============================================================================
# SECRETS MANAGEMENT
# =============================================================================
SECRETS_PROVIDER=local # Options: local, vault, aws, azure, gcp

# =============================================================================
# CORS
# =============================================================================
ALLOWED_ORIGINS=http://localhost:3000,https://app.openclaw.ai

# =============================================================================
# AGENT SANDBOXING
# =============================================================================
SANDBOX_PROVIDER=firecracker # Options: firecracker, gvisor
SANDBOX_CPU_LIMIT=1
SANDBOX_MEMORY_LIMIT_MB=512
SANDBOX_TIMEOUT_SECONDS=300

# =============================================================================
# LOGGING
# =============================================================================
LOG_LEVEL=info # Options: debug, info, warn, error
LOG_FORMAT=json # Options: json, text
